<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" version="29.3.7">
  <diagram id="workflow-architecture" name="Chat Workflow Architecture">
    <mxGraphModel dx="1501" dy="832" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="IzdBYIFqCxf-8v00V4ky-1" connectable="0" parent="1" style="group" value="" vertex="1">
          <mxGeometry height="1040" width="1400" x="160" y="20" as="geometry" />
        </mxCell>
        <mxCell id="title" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=24;fontStyle=1;fontColor=#1a1a1a;" value="MIAI Chat Workflow Architecture" vertex="1">
          <mxGeometry height="40" width="500" x="290" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=13;fontColor=#666666;" value="&lt;div style=&quot;text-align: start;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(102, 102, 102), rgb(149, 149, 149));&quot;&gt;Mastra Workflow (Structured Routing Pattern)&lt;/span&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="25" width="400" x="340" y="35" as="geometry" />
        </mxCell>
        <mxCell id="user" parent="IzdBYIFqCxf-8v00V4ky-1" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;fontSize=12;fontStyle=1;" value="User" vertex="1">
          <mxGeometry height="50" width="30" x="525" y="75" as="geometry" />
        </mxCell>
        <mxCell id="workflow-container" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#999999;strokeWidth=2;dashed=1;arcSize=8;" value="" vertex="1">
          <mxGeometry height="870" width="1080" y="170" as="geometry" />
        </mxCell>
        <mxCell id="workflow-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=15;fontStyle=1;fontColor=#333333;" value="Chat Workflow" vertex="1">
          <mxGeometry height="30" width="200" x="32" y="178" as="geometry" />
        </mxCell>
        <mxCell id="workflow-id" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=10;fontColor=#888888;fontFamily=Courier New;" value="id: &quot;chat-workflow&quot;" vertex="1">
          <mxGeometry height="18" width="200" x="33" y="200" as="geometry" />
        </mxCell>
        <mxCell id="classify" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;arcSize=12;verticalAlign=middle;" value="&lt;b&gt;Step 1: Classify Intent&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#666&quot;&gt;Classifier Agent (Haiku)&lt;br&gt;Structured Output&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="240" x="420" y="230" as="geometry" />
        </mxCell>
        <mxCell id="edge-user-classify" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="user" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=2;strokeColor=#333333;" target="classify">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge-user-label" connectable="0" parent="edge-user-classify" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=10;fontColor=#666;" value="message" vertex="1">
          <mxGeometry relative="1" x="-0.2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="branch-diamond" parent="IzdBYIFqCxf-8v00V4ky-1" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;fontSize=11;fontStyle=1;" value=".branch()" vertex="1">
          <mxGeometry height="60" width="120" x="480" y="350" as="geometry" />
        </mxCell>
        <mxCell id="edge-classify-branch" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="classify" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=2;strokeColor=#333333;" target="branch-diamond">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="simple-step" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;arcSize=12;" value="&lt;b&gt;Direct Response&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#666&quot;&gt;Agent (Haiku)&lt;br&gt;인사말/단순 질문&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="155" x="35" y="460" as="geometry" />
        </mxCell>
        <mxCell id="edge-branch-simple" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="branch-diamond" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#82b366;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" target="simple-step">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="label-simple" connectable="0" parent="edge-branch-simple" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=9;fontColor=#82b366;fontFamily=Courier New;" value="type === &quot;simple&quot;" vertex="1">
          <mxGeometry relative="1" x="-0.15" y="-15" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="atlassian-step" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;arcSize=12;" value="&lt;b&gt;Atlassian Agent Step&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#666&quot;&gt;Agent (Haiku)&lt;br&gt;Confluence / Jira&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="155" x="225" y="460" as="geometry" />
        </mxCell>
        <mxCell id="edge-branch-atl" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="branch-diamond" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#9673a6;exitX=0.25;exitY=1;exitDx=0;exitDy=0;" target="atlassian-step">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="label-atl" connectable="0" parent="edge-branch-atl" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=9;fontColor=#9673a6;fontFamily=Courier New;" value="&quot;atlassian&quot;" vertex="1">
          <mxGeometry relative="1" x="0.1" y="10" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="google-step" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;arcSize=12;" value="&lt;b&gt;Google Search Agent Step&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#666&quot;&gt;Agent (Haiku)&lt;br&gt;웹 검색 / 콘텐츠 추출&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="170" x="415" y="460" as="geometry" />
        </mxCell>
        <mxCell id="edge-branch-ggl" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="branch-diamond" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#9673a6;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" target="google-step">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="label-ggl" connectable="0" parent="edge-branch-ggl" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=9;fontColor=#9673a6;fontFamily=Courier New;" value="&quot;google-search&quot;" vertex="1">
          <mxGeometry relative="1" x="0.15" y="10" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="datahub-step" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;arcSize=12;" value="&lt;b&gt;DataHub Agent Step&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot; color=&quot;#666&quot;&gt;Agent (Haiku)&lt;br&gt;메타데이터 / 리니지&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="155" x="620" y="460" as="geometry" />
        </mxCell>
        <mxCell id="edge-branch-dhb" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="branch-diamond" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#9673a6;exitX=0.75;exitY=1;exitDx=0;exitDy=0;" target="datahub-step">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="label-dhb" connectable="0" parent="edge-branch-dhb" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=9;fontColor=#9673a6;fontFamily=Courier New;" value="&quot;datahub&quot;" vertex="1">
          <mxGeometry relative="1" x="0.1" y="10" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="multi-container" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d6b656;strokeWidth=2;dashed=1;arcSize=8;" value="" vertex="1">
          <mxGeometry height="310" width="260" x="800" y="440" as="geometry" />
        </mxCell>
        <mxCell id="multi-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=11;fontStyle=1;fontColor=#b8860b;" value="Multi-Agent Sub-Workflow" vertex="1">
          <mxGeometry height="22" width="200" x="815" y="445" as="geometry" />
        </mxCell>
        <mxCell id="multi-id" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=9;fontColor=#999;fontFamily=Courier New;" value=".parallel()" vertex="1">
          <mxGeometry height="16" width="100" x="815" y="464" as="geometry" />
        </mxCell>
        <mxCell id="p-atl" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=1.5;arcSize=15;fontSize=10;" value="&lt;b&gt;ATL&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Atlassian&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="72" x="815" y="490" as="geometry" />
        </mxCell>
        <mxCell id="p-ggl" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=1.5;arcSize=15;fontSize=10;" value="&lt;b&gt;GGL&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Google&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="72" x="895" y="490" as="geometry" />
        </mxCell>
        <mxCell id="p-dhb" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=1.5;arcSize=15;fontSize=10;" value="&lt;b&gt;DHB&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;DataHub&lt;/font&gt;" vertex="1">
          <mxGeometry height="50" width="72" x="975" y="490" as="geometry" />
        </mxCell>
        <mxCell id="sync-bar-top" parent="IzdBYIFqCxf-8v00V4ky-1" style="shape=line;html=1;strokeWidth=4;strokeColor=#d6b656;fillColor=none;" value="" vertex="1">
          <mxGeometry height="10" width="210" x="825" y="555" as="geometry" />
        </mxCell>
        <mxCell id="merge-step" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=1.5;arcSize=12;fontSize=10;" value="&lt;b&gt;Merge Results&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#666&quot;&gt;유효 결과 필터링 &amp; 통합&lt;/font&gt;" vertex="1">
          <mxGeometry height="45" width="150" x="855" y="590" as="geometry" />
        </mxCell>
        <mxCell id="edge-patl-sync" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="p-atl" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1;strokeColor=#999;" target="sync-bar-top">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge-pggl-sync" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="p-ggl" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1;strokeColor=#999;" target="sync-bar-top">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge-pdhb-sync" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="p-dhb" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1;strokeColor=#999;" target="sync-bar-top">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge-sync-merge" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="sync-bar-top" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1;strokeColor=#999;" target="merge-step">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge-branch-multi" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="branch-diamond" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#d6b656;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" target="multi-container">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="label-multi" connectable="0" parent="edge-branch-multi" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=9;fontColor=#d6b656;fontFamily=Courier New;" value="&quot;multi-agent&quot;" vertex="1">
          <mxGeometry relative="1" x="-0.1" y="-15" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="mcp-atl" parent="IzdBYIFqCxf-8v00V4ky-1" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;size=12;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=1.5;fontSize=10;" value="&lt;b&gt;Atlassian MCP&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#666&quot;&gt;Streamable HTTP&lt;br&gt;Confluence + Jira&lt;/font&gt;" vertex="1">
          <mxGeometry height="55" width="150" x="130" y="580" as="geometry" />
        </mxCell>
        <mxCell id="mcp-ggl" parent="IzdBYIFqCxf-8v00V4ky-1" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;size=12;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=1.5;fontSize=10;" value="&lt;b&gt;Google Search MCP&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#666&quot;&gt;stdio (local)&lt;/font&gt;" vertex="1">
          <mxGeometry height="55" width="150" x="325" y="580" as="geometry" />
        </mxCell>
        <mxCell id="mcp-dhb" parent="IzdBYIFqCxf-8v00V4ky-1" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;size=12;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=1.5;fontSize=10;" value="&lt;b&gt;DataHub MCP&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#666&quot;&gt;Streamable HTTP&lt;/font&gt;" vertex="1">
          <mxGeometry height="55" width="150" x="525" y="580" as="geometry" />
        </mxCell>
        <mxCell id="edge-atl-mcp" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="atlassian-step" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1;strokeColor=#b85450;dashed=1;" target="mcp-atl">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="302" y="550" />
              <mxPoint x="205" y="550" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge-ggl-mcp" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="google-step" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1;strokeColor=#b85450;dashed=1;" target="mcp-ggl">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="edge-dhb-mcp" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="datahub-step" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1;strokeColor=#b85450;dashed=1;" target="mcp-dhb">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="map-step" parent="IzdBYIFqCxf-8v00V4ky-1" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;size=20;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=1.5;fontSize=11;fontStyle=1;" value=".map()&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#666&quot;&gt;출력 정규화&lt;/font&gt;" vertex="1">
          <mxGeometry height="45" width="200" x="440" y="800" as="geometry" />
        </mxCell>
        <mxCell id="edge-simple-map" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="simple-step" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#999;" target="map-step">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="113" y="770" />
              <mxPoint x="540" y="770" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge-atl-map" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="atlassian-step" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#999;" target="map-step">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="303" y="770" />
              <mxPoint x="540" y="770" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge-ggl-map" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="google-step" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#999;" target="map-step">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="500" y="770" />
              <mxPoint x="540" y="770" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge-dhb-map" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="datahub-step" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#999;" target="map-step">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="698" y="770" />
              <mxPoint x="540" y="770" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="edge-merge-map" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="merge-step" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=1.5;strokeColor=#999;" target="map-step">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="930" y="770" />
              <mxPoint x="540" y="770" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="synthesize" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;arcSize=12;" value="&lt;b&gt;Step Final: Response Synthesis&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size: 10px;&quot; color=&quot;#666&quot;&gt;Final Responser Agent (Haiku)&lt;br&gt;결과 통합 + Persona 기반 포맷팅&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="260" x="410" y="880" as="geometry" />
        </mxCell>
        <mxCell id="edge-map-synth" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="map-step" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=2;strokeColor=#333333;" target="synthesize">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="response" parent="IzdBYIFqCxf-8v00V4ky-1" style="shape=document;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=0.15;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;fontSize=11;" value="&lt;b&gt;User Response&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot; color=&quot;#666&quot;&gt;Streaming (run.stream())&lt;/font&gt;" vertex="1">
          <mxGeometry height="55" width="160" x="460" y="980" as="geometry" />
        </mxCell>
        <mxCell id="edge-synth-resp" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" source="synthesize" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeWidth=2;strokeColor=#333333;" target="response">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="legend-box" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fafafa;strokeColor=#cccccc;strokeWidth=1;arcSize=8;" value="" vertex="1">
          <mxGeometry height="260" width="280" x="1120" y="170" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;fontSize=13;fontStyle=1;fontColor=#333;" value="Legend" vertex="1">
          <mxGeometry height="25" width="80" x="1135" y="175" as="geometry" />
        </mxCell>
        <mxCell id="leg-step" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=1.5;arcSize=12;" value="" vertex="1">
          <mxGeometry height="20" width="30" x="1140" y="210" as="geometry" />
        </mxCell>
        <mxCell id="leg-step-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;" value="Workflow Step (Agent 호출)" vertex="1">
          <mxGeometry height="20" width="200" x="1180" y="210" as="geometry" />
        </mxCell>
        <mxCell id="leg-agent" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=1.5;arcSize=12;" value="" vertex="1">
          <mxGeometry height="20" width="30" x="1140" y="240" as="geometry" />
        </mxCell>
        <mxCell id="leg-agent-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;" value="Worker Agent Step" vertex="1">
          <mxGeometry height="20" width="200" x="1180" y="240" as="geometry" />
        </mxCell>
        <mxCell id="leg-direct" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=1.5;arcSize=12;" value="" vertex="1">
          <mxGeometry height="20" width="30" x="1140" y="270" as="geometry" />
        </mxCell>
        <mxCell id="leg-direct-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;" value="Direct Response / Output" vertex="1">
          <mxGeometry height="20" width="200" x="1180" y="270" as="geometry" />
        </mxCell>
        <mxCell id="leg-control" parent="IzdBYIFqCxf-8v00V4ky-1" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;size=8;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=1.5;" value="" vertex="1">
          <mxGeometry height="20" width="40" x="1135" y="300" as="geometry" />
        </mxCell>
        <mxCell id="leg-control-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;" value="Control Flow (.map / .branch)" vertex="1">
          <mxGeometry height="20" width="200" x="1180" y="300" as="geometry" />
        </mxCell>
        <mxCell id="leg-mcp" parent="IzdBYIFqCxf-8v00V4ky-1" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;size=8;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=1.5;" value="" vertex="1">
          <mxGeometry height="20" width="35" x="1137" y="330" as="geometry" />
        </mxCell>
        <mxCell id="leg-mcp-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;" value="MCP Server (외부 도구)" vertex="1">
          <mxGeometry height="20" width="200" x="1180" y="330" as="geometry" />
        </mxCell>
        <mxCell id="leg-sub" parent="IzdBYIFqCxf-8v00V4ky-1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d6b656;strokeWidth=1.5;dashed=1;" value="" vertex="1">
          <mxGeometry height="20" width="30" x="1140" y="360" as="geometry" />
        </mxCell>
        <mxCell id="leg-sub-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;" value="Sub-Workflow (.parallel)" vertex="1">
          <mxGeometry height="20" width="200" x="1180" y="360" as="geometry" />
        </mxCell>
        <mxCell id="leg-line-solid" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#333;" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1140" y="400" as="sourcePoint" />
            <mxPoint x="1170" y="400" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="leg-line-solid-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;" value="데이터 흐름 (Zod 스키마)" vertex="1">
          <mxGeometry height="20" width="200" x="1180" y="390" as="geometry" />
        </mxCell>
        <mxCell id="leg-line-dashed" edge="1" parent="IzdBYIFqCxf-8v00V4ky-1" style="endArrow=classic;html=1;strokeWidth=1;strokeColor=#b85450;dashed=1;" value="">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1140" y="422" as="sourcePoint" />
            <mxPoint x="1170" y="422" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="leg-line-dashed-label" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=left;verticalAlign=middle;fontSize=10;" value="MCP 연결 (HTTP / stdio)" vertex="1">
          <mxGeometry height="20" width="200" x="1180" y="412" as="geometry" />
        </mxCell>
        <mxCell id="classify-output" parent="IzdBYIFqCxf-8v00V4ky-1" style="text;html=1;align=center;verticalAlign=middle;fillColor=#fff2cc;strokeColor=#d6b656;rounded=1;fontSize=9;" value="&lt;font style=&quot;font-size:9px&quot; face=&quot;Courier New&quot;&gt;{ type, targets[], queries{} }&lt;/font&gt;" vertex="1">
          <mxGeometry height="22" width="180" x="450" y="305" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
